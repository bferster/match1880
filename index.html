<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Census Matcher 1880</title>
	<link rel="stylesheet" href="style.css">
	<style>
		/* Add specific styles for this layout if not in style.css */
		.controls {
			margin-bottom: 20px;
		}

		.tab-btn {
			margin-right: 10px;
		}

		.tab-btn.active {
			background-color: var(--primary);
			color: white;
			border-color: var(--primary);
		}

		.badge.score-high {
			background: #d4edda;
			color: #155724;
		}

		.badge.score-med {
			background: #fff3cd;
			color: #856404;
		}

		.badge.score-low {
			background: #f8d7da;
			color: #721c24;
		}

		/* Spinner */
		#loading-overlay {
			margin: 40px auto;
			text-align: center;
			color: var(--text-muted);
		}

		.spinner {
			width: 40px;
			height: 40px;
			margin: 0 auto 10px;
			border: 4px solid #f3f3f3;
			border-top: 4px solid var(--primary);
			border-radius: 50%;
			animation: spin 1s linear infinite;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}
	</style>
</head>

<body>

	<div class="app-container">
		<header>
			<h1>Census Matcher 1870-1880</h1>
			<div class="status-panel">
				<span id="st-1870" class="badge">Waiting for 1870...</span>
				<span id="st-1880" class="badge">Waiting for 1880...</span>
			</div>
		</header>

		<div class="card controls">
			<p>Click below to match records using the Block strategy.</p>
			<div style="display: flex; justify-content: space-between; align-items: center;">
				<div class="btn-group">
					<button id="btn-run" class="btn primary" disabled>Start Matching</button>
					<button id="btn-save" class="btn success hidden">Save changes.csv</button>
				</div>
				<label style="display: flex; align-items: center; gap: 8px; cursor: pointer; user-select: none;">
					<input type="checkbox" id="chk-boost" checked>
					<span style="font-size: 0.95rem;margin-right:16px">Household boost?</span>
				</label>
			</div>

			<div id="progress-container" class="hidden">
				<div class="progress-bar">
					<div class="fill" id="progress-bar"></div>
				</div>
				<div id="progress-text">0%</div>
			</div>
		</div>


		<div id="context-panel" class="card hidden">
			<div class="context-group">
				<h4>1870 Census Context (±12 Rows)</h4>
				<div id="context-1870" class="context-box">Click a match to view context</div>
			</div>
			<div class="context-group">
				<h4>1880 Census Context (±12 Rows)</h4>
				<div id="context-1880" class="context-box">Click a match to view context</div>
			</div>
		</div>

		<div id="results-panel" class="card hidden">
			<div class="results-header" style="display: flex; justify-content: space-between; align-items: center;">
				<h3>Matched Pairs</h3>
				<div class="search-box" style="display: flex; gap: 8px;">
					<input type="text" id="inp-search" placeholder="Search..."
						style="padding: 6px; border: 1px solid #ccc; border-radius: 4px;">
					<button id="btn-search" class="btn primary"
						style="padding: 6px 12px;margin-right:16px">Find</button>
				</div>
			</div>

			<div class="tabs">
				<button class="tab-btn active" data-tab="1">Tier 1 <span id="cnt-1" class="tab-badge">0</span></button>
				<button class="tab-btn" data-tab="2">Tier 2 <span id="cnt-2" class="tab-badge">0</span></button>
				<button class="tab-btn" data-tab="3">Tier 3 <span id="cnt-3" class="tab-badge">0</span></button>
			</div>


			<div id="loading-overlay" class="hidden">
				<div class="spinner"></div>
				<div>Rendering matches...</div>
			</div>
			<div class="matches-list" id="matches-list">
				<!-- Matches injected here -->
			</div>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
	<script type="module" src="app.js"></script>

</body>
<script>var app;</script>

</html>